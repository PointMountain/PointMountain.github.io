(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{349:function(t,s,a){"use strict";a.r(s);var n=a(33),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"webpack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webpack"}},[t._v("#")]),t._v(" webpack")]),t._v(" "),a("h2",{attrs:{id:"概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[t._v("#")]),t._v(" 概念")]),t._v(" "),a("ul",[a("li",[t._v("module\n各个源码文件，webpack中一切皆模块")]),t._v(" "),a("li",[t._v("chunk\n多模块合并成的，如entry、import()、splitChunk生成的")]),t._v(" "),a("li",[t._v("bundle\n最终的输出文件")])]),t._v(" "),a("h2",{attrs:{id:"基本配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本配置"}},[t._v("#")]),t._v(" 基本配置")]),t._v(" "),a("ul",[a("li",[t._v("拆分配置和merge "),a("code",[t._v("webpack-merge")]),t._v(" "),a("code",[t._v("--config")])]),t._v(" "),a("li",[t._v("启动本地服务 "),a("code",[t._v("webpack-dev-server")])]),t._v(" "),a("li",[t._v("处理ES6 "),a("code",[t._v("babel-loader")])]),t._v(" "),a("li",[t._v("处理样式 loader执行顺序是 从后往前，所以"),a("code",[t._v("loader: ['style-loader', 'css-loader', 'postcss-loader']")]),t._v("，先通过"),a("code",[t._v("postcss-loader")]),t._v("将css内容兼容不同浏览器，再通过"),a("code",[t._v("css-loader")]),t._v("将内容解析为css，最后通过"),a("code",[t._v("style-loader")]),t._v("将内容插入页面style中")]),t._v(" "),a("li",[t._v("处理图片"),a("code",[t._v("url-loader")]),t._v(" "),a("code",[t._v("file-loader")])]),t._v(" "),a("li",[t._v("模块化")])]),t._v(" "),a("h2",{attrs:{id:"高级配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#高级配置"}},[t._v("#")]),t._v(" 高级配置")]),t._v(" "),a("ul",[a("li",[t._v("多入口"),a("br"),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("  entry"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    index"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("basePath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'index.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    other"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("basePath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'other.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  output"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    filename"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[name].[hash].js'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//因为多模块所以第一    部分用入口内部的name命名区分")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),a("li",[t._v("抽离CSS文件\n"),a("code",[t._v("MiniCssExtractPlugin")])]),t._v(" "),a("li",[t._v("抽离公共代码 "),a("code",[t._v("chunk")]),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("  optimization"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    splitChunks"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      chunks"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'all'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* \n      initial 入口 chunk，对于异步导入的文件不处理\n      async 异步 chunk，只对异步导入的文件处理\n      all 全部 chunk\n      */")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//缓存分组")]),t._v("\n      cacheGroups"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//第三方模块")]),t._v("\n        vendor"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vendor'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// chunk 名称")]),t._v("\n          priority"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 权限更高，优先重要！！！")]),t._v("\n          test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/node_modules/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          minSize"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 大小限制")]),t._v("\n          minChunks"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 最少复用过几次")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 公共的模块")]),t._v("\n        common"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'common'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// chunk 名称")]),t._v("\n          priority"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 优先级")]),t._v("\n          minSize"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 公共模块的大小限制")]),t._v("\n          minChunks"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 公共模块最少几次")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),a("li",[t._v("懒加载\n"),a("code",[t._v("import().then()")]),t._v(" 会定义一个chunk")]),t._v(" "),a("li",[t._v("处理JSX")]),t._v(" "),a("li",[t._v("处理Vue\n"),a("code",[t._v("vue-loader")])])]),t._v(" "),a("h2",{attrs:{id:"优化打包效率-开发体验和效率"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优化打包效率-开发体验和效率"}},[t._v("#")]),t._v(" 优化打包效率——开发体验和效率")]),t._v(" "),a("ul",[a("li",[t._v("优化babel-loader\n"),a("ul",[a("li",[t._v("开启缓存\n"),a("code",[t._v("use: ['babel-loader?cacheDirectory']")])]),t._v(" "),a("li",[t._v("明确范围\n使用"),a("code",[t._v("include")]),t._v("或者"),a("code",[t._v("exclude")])])])]),t._v(" "),a("li",[t._v("IgnorePlugin 设置不引入的文件，直接不引入命中的文件，代码中也不存在（可用于生产环境）")]),t._v(" "),a("li",[t._v("noParse 避免重复打包 比如"),a("code",[t._v("vue.min.js")]),t._v("属于已经打过包的，就不会再二次打包 但是还是会引入（可用于生产环境）")]),t._v(" "),a("li",[t._v("happyPack多进程打包（可用于生产环境）\n"),a("ul",[a("li",[t._v("JS单线程，开启多进程打包")]),t._v(" "),a("li",[t._v("提高构建速度（特别是多核CPU）")])])]),t._v(" "),a("li",[t._v("ParallelUglifyPlugin多进程压缩JS（一般用于生产环境）")]),t._v(" "),a("li",[t._v("自动刷新 刷新页面（不可用于生产环境）\n"),a("code",[t._v("watch: true")])]),t._v(" "),a("li",[t._v("热更新（不可用于生产环境）"),a("br"),t._v("\n自动刷新：整个网页全部刷新，速度较慢，状态会丢失"),a("br"),t._v("\n热更新：网页不刷新，状态不丢失")]),t._v(" "),a("li",[t._v("DllPlugin动态链接库插件（不可用于生产环境）\n"),a("ul",[a("li",[t._v("webpack已内置DllPlugin支持")]),t._v(" "),a("li",[t._v("DllPlugin——打包出dll文件")]),t._v(" "),a("li",[t._v("DllReferencePlugin——使用dll文件")])])])]),t._v(" "),a("h2",{attrs:{id:"优化产出代码-产品性能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优化产出代码-产品性能"}},[t._v("#")]),t._v(" 优化产出代码——产品性能")]),t._v(" "),a("ul",[a("li",[t._v("小图片base64编码"),a("code",[t._v("url-loader")])]),t._v(" "),a("li",[t._v("bundle加hash 如果内容变了hash会变导致重新请求，如果没变则会命中缓存")]),t._v(" "),a("li",[t._v("懒加载 "),a("code",[t._v("import().then()")])]),t._v(" "),a("li",[t._v("提取公共代码"),a("code",[t._v("splitChunks")])]),t._v(" "),a("li",[t._v("IgnorePlugin")]),t._v(" "),a("li",[t._v("使用CDN加速"),a("code",[t._v("publicPath: 'http://cdn.xxx.com'")])]),t._v(" "),a("li",[t._v("使用Production"),a("code",[t._v("mode: production")]),t._v(" "),a("ul",[a("li",[t._v("自动开启代码压缩")]),t._v(" "),a("li",[t._v("Vue React等会自动删掉调试代码（如开发环境的warning）")]),t._v(" "),a("li",[t._v("自动启用Tree-Shaking（必须用ES6 Module才可以实现，Commonjs不行）\n"),a("ul",[a("li",[t._v("ES6 Module静态引入，编译时引入")]),t._v(" "),a("li",[t._v("Commonjs动态引入，执行时引入")]),t._v(" "),a("li",[t._v("只有ES6 Module才能静态分析，实现Tree-Shaking")])])])])]),t._v(" "),a("li",[t._v("Scope Hosting\n"),a("ul",[a("li",[t._v("代码体积更小")]),t._v(" "),a("li",[t._v("创建函数作用域更少")]),t._v(" "),a("li",[t._v("代码可读性更好")])])])]),t._v(" "),a("h2",{attrs:{id:"构建流程概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建流程概述"}},[t._v("#")]),t._v(" 构建流程概述")]),t._v(" "),a("h2",{attrs:{id:"babel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#babel"}},[t._v("#")]),t._v(" babel")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("环境搭建&基本配置")]),t._v(" "),a("ul",[a("li",[t._v("环境配置")]),t._v(" "),a("li",[t._v(".babelrc配置")]),t._v(" "),a("li",[t._v("presets和plugins\npreset相当于多个plugin的集合")])])]),t._v(" "),a("li",[a("p",[t._v("babel-polyfill")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("polyfill类似于补丁")])]),t._v(" "),a("li",[a("p",[t._v("core-js和regenerator\ncore-js集成了所有es6之后的polyfill（不支持generator）\nregenerator支持了generator")])]),t._v(" "),a("li",[a("p",[t._v("babel-polyfill是core-js和regenerator的集合 Babel7.4后已弃用")])]),t._v(" "),a("li",[a("p",[t._v("文件较大，需要按需引入")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//.babelrc")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"presets"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@babel/preset-env"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"useBuiltIns"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"usage"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"corejs"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])])]),t._v(" "),a("li",[a("p",[t._v("babel-runtime")]),t._v(" "),a("ul",[a("li",[t._v("babel-polyfill会污染全局环境，如果是做一个独立的web系统，则没什么问题，但是做一个第三方lib，就会有问题")]),t._v(" "),a("li",[t._v("通过babel-runtime就可以避免副作用"),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//.babelrc")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@babel/plugin-transform-runtime"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"absoluteRuntime"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"corejs"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"helpers"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"regenerator"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"useESModules"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);